# library(ProjectTemplate)
# library(zoo)
# setwd("D:/UncertaintyPaper/paper4_revision_new")
# load.project()
#load("cache/error_RCM.RData")
#load("cache/error_STP.RData")
#load("cache/error_VIC.RData")
error_RCM = read.table('data/cal_metrics_RCM_Borg.txt',header=F)
error_STP = read.table('data/cal_metrics_STP_Borg.txt',header=F)
error_VIC = read.table('data/cal_metrics_VIC_Borg_new.txt',header=F)
error_RCM$mean = rowMeans(error_RCM[,c(14,18,22,26)])
error_STP$mean = rowMeans(error_STP[,c(14,18,22,26)])
error_VIC$mean = rowMeans(error_VIC[,c(14,18,22,26)])
error_RCM=error_RCM[order(-error_RCM$mean),]
error_STP=error_STP[order(-error_STP$mean),]
error_VIC=error_VIC[order(-error_VIC$mean),]
error_RCM1= read.table('cache/para_final_RCM.txt',header=F)
error_RCM1$mean = error_RCM1[,27]
error_VIC1= read.table('cache/para_final_VIC.txt',header=F)
error_VIC1$mean = error_VIC1[,27]
error_STP1= read.table('cache/para_final_STP.txt',header=F)
error_STP1$mean = error_STP1[,27]
range_ks = c(1,20)
range_kss = c(10,200)
range_kv = c(0.01,5)
range_c1 = c(0,0.3)
range_c2 = c(0.2,0.8)
range_stip = c(0.2,0.8)
range_fover = c(0.001,5)   #unit /m
range_fdrain = c(0.001,5)   #unit /m
range_Qm = c(0.01,20)    #unit 1e-3 mm/s
range_phi = c(-10,0)    # ft
range_bin = c(0.0005,0.5)   
range_Ds = c(0,0.003)
range_Dm = c(0,0.005)   #ft/h
range_Ws = c(0.92,1)  
nbest=4
c1 = 'green'
#tiff("graphs/figure5-MOEA.tiff", 
     #height = 22.86, width = 12.7, units = 'cm', res = 1200)
windows(5,9)
par(mfrow=c(3,6))
par(mar=c(0.5,3.6,0.3,0.3),mgp=c(2.2,0.5,0),family = "serif")
par(fig=c(0,3.9,8.4,10)/10,new=TRUE)
#for(i in 1:6){
plot((error_RCM[,1]-range_ks[1])/(range_ks[2]-range_ks[1]),error_RCM$mean,ylim=c(0.3,0.7),xaxt="n",ylab='NSE',yaxt="n")
axis(side=2, cex.axis=1.0,tck=-0.025,family = 'serif')
text(x=0.1,y=0.68,expression(bold("K"["s_all"])),font=2)
text(x=0.8,y=0.685,'RCM-HRR')
points((error_RCM1[1:nbest,1]-range_ks[1])/(range_ks[2]-range_ks[1]),error_RCM1$mean[1:nbest],col='red')
points((error_RCM1[(nbest+1):10,1]-range_ks[1])/(range_ks[2]-range_ks[1]),error_RCM1$mean[(nbest+1):10],col=c1)
par(mar=c(0.5,0.3,0.3,0.3),mgp=c(2.2,0.8,0),family = "serif")
par(fig=c(3.9,6.95,8.4,10)/10,new=TRUE)
plot((error_STP[,1]-range_ks[1])/(range_ks[2]-range_ks[1]),error_STP$mean,ylim=c(0.3,0.7),xaxt="n",yaxt='n',ylab='')
text(x=0.1,y=0.68,expression(bold("K"["s_all"])),font=2)
text(x=0.8,y=0.685,'STP-HRR')
points((error_STP1[1:nbest,1]-range_ks[1])/(range_ks[2]-range_ks[1]),error_STP1$mean[1:nbest],col='red')
points((error_STP1[(nbest+1):10,1]-range_ks[1])/(range_ks[2]-range_ks[1]),error_STP1$mean[(nbest+1):10],col=c1)
par(fig=c(6.95,10,8.4,10)/10,new=TRUE)
plot((error_VIC[,1]-range_ks[1])/(range_ks[2]-range_ks[1]),error_VIC$mean,ylim=c(0.3,0.7),xaxt="n",yaxt='n',ylab='')
text(x=0.1,y=0.68,expression(bold("K"["s_all"])),font=2)
text(x=0.8,y=0.685,'VIC-HRR')
points((error_VIC1[1:nbest,1]-range_ks[1])/(range_ks[2]-range_ks[1]),error_VIC1$mean[1:nbest],col='red')
points((error_VIC1[(nbest+1):10,1]-range_ks[1])/(range_ks[2]-range_ks[1]),error_VIC1$mean[(nbest+1):10],col=c1)

par(mar=c(0.5,3.6,0.3,0.3),mgp=c(2.2,0.5,0),family = "serif")
par(fig=c(0,3.9,6.8,8.4)/10,new=TRUE)
plot((error_RCM[,3]-range_kss[1])/(range_kss[2]-range_kss[1]),error_RCM$mean,ylim=c(0.3,0.7),xaxt="n",ylab='NSE',yaxt="n")
axis(side=2, cex.axis=1.0,tck=-0.025,family = 'serif')
text(x=0.1,y=0.68,expression(bold("K"["ss_all"])),font=2)
text(x=0.8,y=0.685,'RCM-HRR')
points((error_RCM1[1:nbest,3]-range_kss[1])/(range_kss[2]-range_kss[1]),error_RCM1$mean[1:nbest],col='red')
points((error_RCM1[(nbest+1):10,3]-range_kss[1])/(range_kss[2]-range_kss[1]),error_RCM1$mean[(nbest+1):10],col=c1)
par(mar=c(0.5,0.3,0.3,0.3),mgp=c(2.2,0.8,0),family = "serif")
par(fig=c(3.9,6.95,6.8,8.4)/10,new=TRUE)
plot((error_STP[,2]-range_kss[1])/(range_kss[2]-range_kss[1]),error_STP$mean,ylim=c(0.3,0.7),xaxt="n",yaxt='n',ylab='')
text(x=0.1,y=0.68,expression(bold("K"["ss_all"])),font=2)
text(x=0.8,y=0.685,'STP-HRR')
points((error_STP1[1:nbest,2]-range_kss[1])/(range_kss[2]-range_kss[1]),error_STP1$mean[1:nbest],col='red')
points((error_STP1[(nbest+1):10,2]-range_kss[1])/(range_kss[2]-range_kss[1]),error_STP1$mean[(nbest+1):10],col=c1)
par(fig=c(6.95,10,6.8,8.4)/10,new=TRUE)
plot((error_VIC[,2]-range_kss[1])/(range_kss[2]-range_kss[1]),error_VIC$mean,ylim=c(0.3,0.7),xaxt="n",yaxt='n',ylab='')
text(x=0.1,y=0.68,expression(bold("K"["ss_all"])),font=2)
text(x=0.8,y=0.685,'VIC-HRR')
points((error_VIC1[1:nbest,2]-range_kss[1])/(range_kss[2]-range_kss[1]),error_VIC1$mean[1:nbest],col='red')
points((error_VIC1[(nbest+1):10,2]-range_kss[1])/(range_kss[2]-range_kss[1]),error_VIC1$mean[(nbest+1):10],col=c1)

par(mar=c(0.5,3.6,0.3,0.3),mgp=c(2.2,0.5,0),family = "serif")
par(fig=c(0,3.9,5.2,6.8)/10,new=TRUE)
plot((error_RCM[,2]-range_kv[1])/(range_kv[2]-range_kv[1]),error_RCM$mean,ylim=c(0.3,0.7),xaxt="n",ylab='NSE',yaxt="n")
axis(side=2, cex.axis=1.0,tck=-0.025,family = 'serif')
text(x=0.1,y=0.68,expression(bold("K"["sat_all"])),font=2)
text(x=0.8,y=0.685,'RCM-HRR')
points((error_RCM1[1:nbest,2]-range_kv[1])/(range_kv[2]-range_kv[1]),error_RCM1$mean[1:nbest],col='red')
points((error_RCM1[(nbest+1):10,2]-range_kv[1])/(range_kv[2]-range_kv[1]),error_RCM1$mean[(nbest+1):10],col=c1)
par(fig=c(3.9,6.95,5.2,6.8)/10,new=TRUE)
par(mar=c(0.5,0.3,0.3,0.3),mgp=c(2.2,0.8,0),family = "serif")
plot((error_STP[,3]-range_fover[1])/(range_fover[2]-range_fover[1]),error_STP$mean,ylim=c(0.3,0.7),xaxt="n",yaxt='n',ylab='')
text(x=0.1,y=0.68,expression(bold("f"["over"])),font=2)
text(x=0.8,y=0.685,'STP-HRR')
points((error_STP1[1:nbest,3]-range_fover[1])/(range_fover[2]-range_fover[1]),error_STP1$mean[1:nbest],col='red')
points((error_STP1[(nbest+1):10,3]-range_fover[1])/(range_fover[2]-range_fover[1]),error_STP1$mean[(nbest+1):10],col=c1)
par(fig=c(6.95,10,5.2,6.8)/10,new=TRUE)
plot((error_VIC[,3]-range_bin[1])/(range_bin[2]-range_bin[1]),error_VIC$mean,ylim=c(0.3,0.7),xaxt="n",yaxt='n',ylab='')
text(x=0.1,y=0.68,expression(bold("b"["in"])),font=2)
text(x=0.8,y=0.685,'VIC-HRR')
points((error_VIC1[1:nbest,3]-range_bin[1])/(range_bin[2]-range_bin[1]),error_VIC1$mean[1:nbest],col='red')
points((error_VIC1[(nbest+1):10,3]-range_bin[1])/(range_bin[2]-range_bin[1]),error_VIC1$mean[(nbest+1):10],col=c1)

par(mar=c(0.5,3.6,0.3,0.3),mgp=c(2.2,0.5,0),family = "serif")
par(fig=c(0,3.9,3.6,5.2)/10,new=TRUE)
plot((error_RCM[,4]-range_c1[1])/(range_c1[2]-range_c1[1]),error_RCM$mean,ylim=c(0.3,0.7),xaxt="n",ylab='NSE',yaxt="n")
axis(side=2, cex.axis=1.0,tck=-0.025,family = 'serif')
text(x=0.1,y=0.68,expression(bold("C"[1])),font=2)
text(x=0.8,y=0.685,'RCM-HRR')
points((error_RCM1[1:nbest,4]-range_c1[1])/(range_c1[2]-range_c1[1]),error_RCM1$mean[1:nbest],col='red')
points((error_RCM1[(nbest+1):10,4]-range_c1[1])/(range_c1[2]-range_c1[1]),error_RCM1$mean[(nbest+1):10],col=c1)
par(fig=c(3.9,6.95,3.6,5.2)/10,new=TRUE)
par(mar=c(0.5,0.3,0.3,0.3),mgp=c(2.2,0.8,0),family = "serif")
plot((error_STP[,4]-range_fdrain[1])/(range_fdrain[2]-range_fdrain[1]),error_STP$mean,ylim=c(0.3,0.7),
     xaxt="n",yaxt='n',ylab='')
text(x=0.1,y=0.68,expression(bold("f"["drain"])),font=2)
text(x=0.8,y=0.685,'STP-HRR')
points((error_STP1[1:nbest,4]-range_fdrain[1])/(range_fdrain[2]-range_fdrain[1]),error_STP1$mean[1:nbest],col='red')
points((error_STP1[(nbest+1):10,4]-range_fdrain[1])/(range_fdrain[2]-range_fdrain[1]),error_STP1$mean[(nbest+1):10],col=c1)
par(fig=c(6.95,10,3.6,5.2)/10,new=TRUE)
plot((error_VIC[,4]-range_Ds[1])/(range_Ds[2]-range_Ds[1]),error_VIC$mean,ylim=c(0.3,0.7),xaxt="n",yaxt='n',ylab='')
text(x=0.1,y=0.68,expression(bold("D"["s"])),font=2)
text(x=0.8,y=0.685,'VIC-HRR')
points((error_VIC1[1:nbest,4]-range_Ds[1])/(range_Ds[2]-range_Ds[1]),error_VIC1$mean[1:nbest],col='red')
points((error_VIC1[(nbest+1):10,4]-range_Ds[1])/(range_Ds[2]-range_Ds[1]),error_VIC1$mean[(nbest+1):10],col=c1)

par(mar=c(0.5,3.6,0.3,0.3),mgp=c(2.2,0.5,0),family = "serif")
par(fig=c(0,3.9,2,3.6)/10,new=TRUE)
plot((error_RCM[,5]-range_c2[1])/(range_c2[2]-range_c2[1]),error_RCM$mean,ylim=c(0.3,0.7),xaxt="n",ylab='NSE',yaxt="n")
axis(side=2, cex.axis=1.0,tck=-0.025,family = 'serif')
text(x=0.1,y=0.68,expression(bold("C"[2])),font=2)
text(x=0.8,y=0.685,'RCM-HRR')
points((error_RCM1[1:nbest,5]-range_c2[1])/(range_c2[2]-range_c2[1]),error_RCM1$mean[1:nbest],col='red')
points((error_RCM1[(nbest+1):10,5]-range_c2[1])/(range_c2[2]-range_c2[1]),error_RCM1$mean[(nbest+1):10],col=c1)
par(fig=c(3.9,6.95,2,3.6)/10,new=TRUE)
par(mar=c(0.5,0.3,0.3,0.3),mgp=c(2.2,0.8,0),family = "serif")
plot((error_STP[,5]-range_Qm[1])/(range_Qm[2]-range_Qm[1]),error_STP$mean,ylim=c(0.3,0.7),xaxt="n",yaxt='n',ylab='')
text(x=0.1,y=0.68,expression(bold("Q"["m"])),font=2)
text(x=0.8,y=0.685,'STP-HRR')
points((error_STP1[1:nbest,5]-range_Qm[1])/(range_Qm[2]-range_Qm[1]),error_STP1$mean[1:nbest],col='red')
points((error_STP1[(nbest+1):10,5]-range_Qm[1])/(range_Qm[2]-range_Qm[1]),error_STP1$mean[(nbest+1):10],col=c1)
par(fig=c(6.95,10,2,3.6)/10,new=TRUE)
plot((error_VIC[,5]-range_Dm[1])/(range_Dm[2]-range_Dm[1]),error_VIC$mean,ylim=c(0.3,0.7),xaxt="n",yaxt='n',ylab='')
text(x=0.1,y=0.68,expression(bold("D"["m"])),font=2)
text(x=0.8,y=0.685,'VIC-HRR')
points((error_VIC1[1:nbest,5]-range_Dm[1])/(range_Dm[2]-range_Dm[1]),error_VIC1$mean[1:nbest],col='red')
points((error_VIC1[(nbest+1):10,5]-range_Dm[1])/(range_Dm[2]-range_Dm[1]),error_VIC1$mean[(nbest+1):10],col=c1)

par(mar=c(3.6,3.6,0.3,0.3),mgp=c(2.2,0.5,0),family = "serif")
par(fig=c(0,3.9,0,2)/10,new=TRUE)
plot((error_RCM[,6]-range_stip[1])/(range_stip[2]-range_stip[1]),error_RCM$mean,ylim=c(0.3,0.7),xlab='',
     xaxt="n",ylab='NSE',yaxt="n")
axis(side=2, cex.axis=1.0,tck=-0.025,family = 'serif')
axis(side=1, cex.axis=1.0,tck=-0.025,family = 'serif')
text(x=0.1,y=0.68,expression(bold(theta["t"])),font=2)
text(x=0.8,y=0.685,'RCM-HRR')
points((error_RCM1[1:nbest,6]-range_stip[1])/(range_stip[2]-range_stip[1]),error_RCM1$mean[1:nbest],col='red')
points((error_RCM1[(nbest+1):10,6]-range_stip[1])/(range_stip[2]-range_stip[1]),error_RCM1$mean[(nbest+1):10],col=c1)
par(fig=c(3.9,6.95,0,2)/10,new=TRUE)
par(mar=c(3.6,0.3,0.3,0.3),mgp=c(2.2,0.5,0),family = "serif")
plot((error_STP[,6]-range_phi[1])/(range_phi[2]-range_phi[1]),error_STP$mean,ylim=c(0.3,0.7),xlab='Normalized Range',
     yaxt='n',ylab='',xaxt="n")
axis(side=1, cex.axis=1.0,tck=-0.025,family = 'serif')
text(x=0.1,y=0.68,expression(bold(phi["sat"])),font=2)
text(x=0.8,y=0.685,'STP-HRR')
points((error_STP1[1:nbest,6]-range_phi[1])/(range_phi[2]-range_phi[1]),error_STP1$mean[1:nbest],col='red')
points((error_STP1[(nbest+1):10,6]-range_phi[1])/(range_phi[2]-range_phi[1]),error_STP1$mean[(nbest+1):10],col=c1)
par(fig=c(6.95,10,0,2)/10,new=TRUE)
plot((error_VIC[,6]-range_Ws[1])/(range_Ws[2]-range_Ws[1]),error_VIC$mean,ylim=c(0.3,0.7),xlab='',
     yaxt='n',ylab='',xaxt="n")
axis(side=1, cex.axis=1.0,tck=-0.025,family = 'serif')
text(x=0.1,y=0.68,expression(bold("W"["s"])),font=2)
text(x=0.8,y=0.685,'VIC-HRR')
points((error_VIC1[1:nbest,6]-range_Ws[1])/(range_Ws[2]-range_Ws[1]),error_VIC1$mean[1:nbest],col='red')
points((error_VIC1[(nbest+1):10,6]-range_Ws[1])/(range_Ws[2]-range_Ws[1]),error_VIC1$mean[(nbest+1):10],col=c1)

#dev.off()